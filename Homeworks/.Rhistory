knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE, tidy = TRUE)
library(alr4)
cities <- read.table("Angell.txt", header = TRUE)
scatterplotMatrix(~moralIntegration + heterogeneity + mobility, data = cities, smoother = FALSE, diagonal = "qqplot")
m1 <- lm(moralIntegration ~ heterogeneity, data = cities)
summary(m1)
m2 <- lm(moralIntegration ~ heterogeneity + mobility, data = cities)
avPlots(m2)
summary(m2)
confint(m1)
confint(m2)
set.seed(100)
n = dim(cities)[1]
cities$social = with(cities, heterogeneity+mobility+rnorm(n,0,.1))
mod1 = lm(moralIntegration âˆ¼ heterogeneity + mobility + social, data= cities)
mod1 = lm(moralIntegration ~ heterogeneity + mobility + social, data= cities)
summary(mod1)
summary(m2)
summary(mod1)
View(cities)
?with
summary(mod1)
scatterplotMatrix(~moralIntegration + heterogeneity + mobility + social, data = cities, smoother = FALSE, diagonal = "qqplot")
?rnorm
summary(mod1)
scatterplotMatrix(~moralIntegration + heterogeneity + mobility + social, data = cities, smoother = FALSE, diagonal = "qqplot")
summary(mod1)
summary(m2)
?confint
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE, tidy = TRUE)
confint(m1, level = .97)
confint(m2, level = .97)
confint(m1, level = .97)
confint(m2, level = .97)
confint(m1, level = .97)
confint(m2, level = .97)
summary(mod1)
scatterplotMatrix(~moralIntegration + heterogeneity + mobility
+ social, data = cities, smoother = FALSE, diagonal = "qqplot")
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE, tidy = TRUE)
library(alr4)
cities <- read.table("Angell.txt", header = TRUE)
scatterplotMatrix(~moralIntegration + heterogeneity +
mobility, data = cities, smoother = FALSE, diagonal = "qqplot")
m1 <- lm(moralIntegration ~ heterogeneity, data = cities)
summary(m1)
m2 <- lm(moralIntegration ~ heterogeneity + mobility, data = cities)
avPlots(m2)
summary(m2)
confint(m1, level = .97)
confint(m2, level = .97)
set.seed(100)
n = dim(cities)[1]
cities$social = with(cities, heterogeneity+mobility+rnorm(n,0,.1))
mod1 = lm(moralIntegration ~ heterogeneity + mobility + social, data= cities)
summary(mod1)
scatterplotMatrix(~moralIntegration + heterogeneity + mobility
+ social, data = cities, smoother = FALSE, diagonal = "qqplot")
library(GGally)
ggpairs(mod1)
ggpairs(cities)
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE, tidy = TRUE)
library(alr4)
cities <- read.table("Angell.txt", header = TRUE)
scatterplotMatrix(~moralIntegration + heterogeneity +
mobility, data = cities, smoother = FALSE, diagonal = "qqplot")
summary(cities)
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE, tidy = TRUE)
library(alr4)
girls <- BGSgirls
attach(girls)
girls$ave <- (WT2+WT9+WT18)/3
girls$lin <- WT18-WT2
girls$quad <- WT2-2*WT9+WT18
detach(girls)
m1 <- lm(BMI18 ~ ave + lin + quad, data = girls)
summary(m1)
bank <- Transact
m1 <- lm(time ~ t1 + t2, data = bank)
m2 <- lm(time ~ a + d, data = bank)
View(bank)
bank$a <- (bank$t1 + bank$t2)/2
bank$d <- bank$t1 - bank$t2
m2 <- lm(time ~ a + d, data = bank)
m3 <- lm(time ~ t2 + d, data = bank)
m4 <- lm(time ~ t1 + t2 + a + d, data = bank)
summary(m4)
summary(m1)
summary(m2)
summary(m3)
summary(m4)
summary(m1)
summary(m3)
summary(m2)
summary(m3)
summary(m2)
summary(m4)
summary(m2)
summary(m1)
summary(m2)
summary(m3)
summary(m4)
summary(m1)
summary(m1)
summary(m2)
summary(m3)
summary(m1)
summary(m4)
summary(m1)
summary(m4)
summary(m1)
summary(m2)
summary(m3)
summary(m2)
summary(m3)
summary(m2)
summary(m3)
summary(m2)
summary(m2)
summary(m3)
summary(m2)
summary(m2)
summary(m3)
summary(m1)
summary(m2)
summary(m3)
summary(m1)
summary(m3)
summary(m3)
summary(m1)
summary(m2)
summary(m3)
summary(m4)
summary(m1)
summary(m2)
summary(m3)
summary(m4)
summary(m2)
summary(m3)
summary(m2)
summary(m1)
summary(m2)
summary(m3)
summary(m2)
summary(m3)
summary(m2)
summary(m4)
summary(m1)
summary(m2)
summary(m3)
summary(m2)
summary(m1)
summary(m2)
summary(m3)
summary(m1)
summary(m3)
summary(m1)
summary(m3)
summary(m1)
summary(m2)
summary(m3)
library(GGally)
ggpairs(bank)
un <- UN11
lm(log(fertility) ~ pctUrban, data = un)
exp(-0.0101)
?UN11
100*((-0.0101)-1)
100*((-0.01)-1)
un <- UN11
lm(log(fertility) ~ log(ppgdp) + lifeExpF)
lm(log(fertility) ~ log(ppgdp) + lifeExpF, data = un)
mun <- lm(log(fertility) ~ log(ppgdp) + lifeExpF, data = un)
coef(summary(mun))
ppgdpco <- coef(summary(mun))[2,1]
ppgdpco
ppgdpco/4
ppgdpco*25
ppgdpco
ppgdpco*.25
100*((ppgdpco*.25)-1)
?exp
100*(exp(log(1.25)ppgdpco)-1)
100*(exp(log(1.25)*ppgdpco)-1)
100*(exp(log(1.25))*ppgdpco)-1)
100*((exp(log(1.25))*ppgdpco)-1)
100*(exp(log(1.25)*ppgdpco)-1)
100*(exp(log(1.25)*ppgdpco)-1)
exp(-.028)
exp(-.028)-1
100*exp(-.028)-1
exp(-.028)-1
100*(exp(-.028)-1)
100*(exp(-0.01)-1)
exp(-0.01)
exp(-0.01)-1
100*(exp(log(1.25*ppgdpco))-1)
log1.25
log(1.25)
log(1.25)*ppgdpco
exp(-0.01460192)
1-0.9855042
100* 0.0144958
100*(exp(log(1.25)*ppgdpco)-1)
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE, tidy = TRUE)
library(alr4)
girls <- BGSgirls
attach(girls)
girls$ave <- (WT2+WT9+WT18)/3
girls$lin <- WT18-WT2
girls$quad <- WT2-2*WT9+WT18
detach(girls)
m1 <- lm(BMI18 ~ ave + lin + quad, data = girls)
summary(m1)
bank <- Transact
bank$a <- (bank$t1 + bank$t2)/2
bank$d <- bank$t1 - bank$t2
m1 <- lm(time ~ t1 + t2, data = bank)
m2 <- lm(time ~ a + d, data = bank)
m3 <- lm(time ~ t2 + d, data = bank)
m4 <- lm(time ~ t1 + t2 + a + d, data = bank)
summary(m4)
summary(m1)
summary(m2)
summary(m3)
summary(m4)
library(GGally)
ggpairs(bank)
100*(exp(-0.01)-1)
un <- UN11
mun <- lm(log(fertility) ~ log(ppgdp) + lifeExpF, data = un)
ppgdpco <- coef(summary(mun))[2,1]
100*(exp(log(1.25)*ppgdpco)-1)
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE, tidy = TRUE)
repro <- read.table("./Robey.txt")
m1 <- lm(tfr ~ region, data = repro)
summary(m1)
vcov(m1)
require(alr4)
names(UN11)
class(UN11$group)
levels(UN11$group)
str(UN11)
plot(lifeExpF ~ group, data=UN11)
Boxplot(lifeExpF ~ group, data=UN11, id.n=2)
# Let's look at the dummy variables
head(model.matrix(~ -1 + group, UN11), 10)
# And this is what R does by default (model matrix X)
head(model.matrix(~group, UN11), 10)
m1=lm(lifeExpF~group,data=UN11)
summary(m1)$coef
bd=summary(m1)$coef
plot(Effect(c("group"), m1))
m1 <- lm(tfr ~ region, data = repro)
plot(Effect(c("region"), m1))
plot(Effect(c("region"), m1))
?Effect
summary(m1)
a=c(0,1,-1)
se_b2b3=sqrt(t(a)%*%vcov(m1)%*%a)
a=c(0,1,-1)
rm(list=ls())
repro <- read.table("./Robey.txt")
m1 <- lm(tfr ~ region, data = repro)
summary(m1)
a=c(0,1,-1)
se_b2b3=sqrt(t(a)%*%vcov(m1)%*%a)
vcov(m1)
a=c(0,1,-1,0)
se_b2b3=sqrt(t(a)%*%vcov(m1)%*%a)
se_b2b3
b2b3=as.numeric(coef(m1)[2]-coef(m1)[3])
t_val=b2b3/se_b2b3
p_val=2*(1-pt(abs(t_val),m1$df))
c("b2-b3"=b2b3,"SE"=se_b2b3,"t-Value"=t_val,"p-Value"=p_val)
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE, tidy = TRUE)
rm(list=ls())
repro <- read.table("./Robey.txt")
m1 <- lm(tfr ~ region, data = repro)
summary(m1)
a=c(0,1,-1,0)
se_b2b3=sqrt(t(a)%*%vcov(m1)%*%a)
se_b2b3
b2b3=as.numeric(coef(m1)[2]-coef(m1)[3])
t_val=b2b3/se_b2b3
p_val=2*(1-pt(abs(t_val),m1$df))
c("b2-b3"=b2b3,"SE"=se_b2b3,"t-Value"=t_val,"p-Value"=p_val)
library(alr4)
plot(Effect(c("region"), m1))
scatterplot(tfr ~ contraceptors | region, data=repro,
smooth=FALSE, boxplots=FALSE,
ylab="Total fertility rate")
m2 <- lm(tfr ~ region*contraceptors, data = repro)
summary(m2)
summary(m2)
mfinal <- lm(tfr ~ region + contraceptors, data = repro)
summary(mfinal)
summary(lm(tfr ~ contraceptors, data = repro))
scatterplot(tfr ~ contraceptors, data=repro,
smooth=FALSE, boxplots=FALSE,
ylab="Total fertility rate")
mfinal <- lm(tfr ~ contraceptors, data = repro)
mfinal <- lm(tfr ~ contraceptors, data = repro)
summary(mfinal)
mtry1 <- lm(tfr ~ region + contraceptors, data = repro)
summary(coef(mtry1))$r.square
summary(coef(mtry1))$r.squared
summary(mtry1)$r.squared
summary(mtry1)
fmtry2 <- lm(tfr ~ contraceptors, data = repro)
summary(fmtry2)
summary(fmtry1)
fmtry1 <- lm(tfr ~ region + contraceptors, data = repro)
summary(fmtry1)
summary(fmtry1)
summary(fmtry2)
summary(fmtry1)
summary(fmtry1)
summary(fmtry2)
summary(mfinal)
summary(fmtry1)
summary(fmtry2)
summary(fmtry1)
scatterplot(tfr ~ contraceptors, data=repro,
smooth=FALSE, boxplots=FALSE,
ylab="Total fertility rate")
scatterplot(tfr ~ contraceptors, data=repro,
smooth=FALSE, boxplots=FALSE,
ylab="Total fertility rate")
summary(repro)
newdata <- data.frame(contraceptors = 37.44, region = "Asia")
newdata
predict(mfinal, newdata, interval = "predict", level = 0.95)
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE, tidy = TRUE)
rm(list=ls())
repro <- read.table("./Robey.txt")
m1 <- lm(tfr ~ region, data = repro)
summary(m1)
a=c(0,1,-1,0)
se_b2b3=sqrt(t(a)%*%vcov(m1)%*%a)
se_b2b3
b2b3=as.numeric(coef(m1)[2]-coef(m1)[3])
t_val=b2b3/se_b2b3
p_val=2*(1-pt(abs(t_val),m1$df))
c("b2-b3"=b2b3,"SE"=se_b2b3,"t-Value"=t_val,"p-Value"=p_val)
library(alr4)
plot(Effect(c("region"), m1))
scatterplot(tfr ~ contraceptors | region, data=repro,
smooth=FALSE, boxplots=FALSE,
ylab="Total fertility rate")
m2 <- lm(tfr ~ region*contraceptors, data = repro)
summary(m2)
fmtry1 <- lm(tfr ~ region + contraceptors, data = repro)
summary(fmtry1)
fmtry2 <- lm(tfr ~ contraceptors, data = repro)
summary(fmtry2)
mfinal <- lm(tfr ~ contraceptors, data = repro)
scatterplot(tfr ~ contraceptors, data=repro,
smooth=FALSE, boxplots=FALSE,
ylab="Total fertility rate")
summary(repro)
newdata <- data.frame(contraceptors = 37.44, region = "Asia")
predict(mfinal, newdata, interval = "predict", level = 0.95)
newdata <- data.frame(contraceptors = 37.44)
predict(mfinal, newdata, interval = "predict", level = 0.95)
newdata <- data.frame(contraceptors = 37.44, region = "Asia")
predict(mfinal, newdata, interval = "predict", level = 0.95)
predict(fmtry1, newdata, interval = "predict", level = 0.95)
predict(mfinal, newdata, interval = "predict", level = 0.95)
predict(fmtry1, newdata, interval = "predict", level = 0.95)
predict(mfinal, newdata, interval = "predict", level = 0.95)

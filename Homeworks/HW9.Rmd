---
title: "S631 HW8"
author: "Erik Parker"
date: "October 21, 2017"
output: pdf_document
---

```{r setup, include=FALSE, message=FALSE, warning=FALSE, tidy=TRUE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE, tidy = TRUE)
```

### 1. ALR 5.14:  Using the data file *BGSall*, consider the regression of *HT18* on *HT9* and the grouping factor *Sex.*

```{r}

rm(list=ls())

library(alr4)

Berkley <- BGSall

Berkley$sex <- ifelse(Berkley$Sex=="0","male","female")

```

#### 5.14.1: Draw the scatterplot of *HT18* versus *HT9*, using a different symbol for males and females. Comment on the information in the graph about an appropriate mean function for these data.

```{r}

scatterplot(HT18~HT9 | sex, data = Berkley, smooth=FALSE, boxplots=FALSE)

```

> From this plot, it seems pretty clear that there is real seperation between the male and female groups in terms of their height.  The intercepts of the two lines seem to be different, with the male one higher than the female one, but the slopes of the lines appear to be the same, or very close to the same.  Furthermore, there is also a clear relationship in both sexes, that as the height at age 9 increases, so too does the height at age 18.  This suggests to me that a proper mean function for these data will be one with the continuous *HT9* and the categorical *sex* as predictors, but no interaction.  So, it will be of the form: $HT18 ~ HT9 + sex$.


#### 5.14.2  Obtain the appropriate test for a parallel regression model.

```{r}

mpar <- lm(HT18 ~ HT9 + sex, data = Berkley)

summary(mpar)

```

> Looks good! Explains quite a bit of the variation, and the coefficients for both the continuous and categorical regressors are very significant.


#### Assuming the parallel regression model is adequate, estimate a 95% confidence interval for the difference between males and females. For the parallel regression model, this is the difference in the intercepts of the two groups.

```{r}

confint(mpar, level = 0.95)

```

> So, based on my previous model, we see here that we are 95% confident that the true coefficient obtained when we move the females to males, is within the interval of 10.528 to 12.864.  This means that we are 95% confident that the true increase in height seen in 18 year olds in this study is between 10.528 cm and 12.864 cm when we move from females to males.


### 2. Show the following equalitites: 

Work in notebook, insert picture?


### ALR 6.4

### 6.4: With the UN data, consider testing *NH: lifeExpF~log(ppgdp) + group:log(ppgdp)* *AH : lifeExpF~group + log(ppgdp) + group:log(ppgdp)* The AH model is the most general model given at (6.10), but the NH was not given previously.

```{r}

un <- UN11

m1 <- lm(lifeExpF ~ log(ppgdp) + group:log(ppgdp), data = un)
m2 <- lm(lifeExpF ~ group+log(ppgdp)+group:log(ppgdp), data = un)

```

#### 6.4.1: What is the meaning of the NH model?

> This NH model here is stating that the mean function is fully described by this first set of regressors, *log(ppgdp)* and the interaction between *group* and *log(ppgdp)*, and that there is no influence of the main effects from *group*.

#### 6.4.2 Perform the test and summarize the results

```{r}

anova(m1, m2)

```

> From this test, we can see that we got a p-value of about 0.06 when comparing the reduced (*m1*) and full (*m2*) models outlined above.  This means that, with an alpha of 0.05, we are unable to reject the null hypothesis that the mean function is fully described by the first reduced model, containing the regressors *log(ppgdp)* and the interaction *group:log(ppgdp)*.  So, we can't reject the hypothesis that the estimated coefficient associated with the main effect for *group* is equal to zero, meaning that regressor does not have an effect on lifeExpF when *log(ppgdp)* and *group:log(ppgdp)* are already present in the model.

> So, here we would (just barely with this p-value) conclude that the reduced null model is sufficient to explain the response, and that there is no need to include *group* in the model.

#### In addition, using the full model, perform the test $$ H_0 : \beta_{02} - \beta_{03} = 14~~and~~\beta_{12} + \beta_{13} =0.2$$ with $H_A :$ at least one equality doesn't hold.  Show your work.  In addition, how could you interpret this test?

```{r}

summary(m2)
# here beta_02 corresponds to groupother, beta_03 to groupafrica, beta_12 to groupother:log(ppgdp) and beta_13 to groupafrica:log(ppgdp)

```

